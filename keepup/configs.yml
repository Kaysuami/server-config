global:
  files:
    plugins/Geary:
      deleteUntracked: true
      keep:
        - config.yml
        - resourcepack.zip
feat/mobs:
  copyPaths:
    - source: plugins/Geary/prefabs/mineinabyss/mobs
      dest: plugins/Geary/prefabs/mineinabyss/mobs
    - source: plugins/Geary/spawns
      dest: plugins/Geary/spawns
    - source: plugins/Geary/spawning.yml
      dest: plugins/Geary/
    - source: plugins/MythicMobs
      dest: plugins/MythicMobs
    - feat/disable_mythic_examples
  files:
    plugins/MythicMobs:
      deleteUntracked: true
      keep:
        - config/
        - data/
        - stats.yml
feat/emotes:
  copyPaths:
    - source: plugins/Emojy
      dest: plugins/Emojy
  files:
    plugins/Emojy:
      deleteUntracked: true
      keep:
        - gifs/ # Image sequences get generated in here
        - fonts/
        - pack.zip
feat/blocks:
  copyPaths:
    - source: plugins/Blocky
      dest: plugins/Blocky
    - source: plugins/Geary/prefabs/mineinabyss/blocks
      dest: plugins/Geary/prefabs/mineinabyss/blocks

feat/chat:
  copyPaths:
    - source: plugins/Chatty
      dest: plugins/Chatty

feat/cosmetics:
  copyPaths:
    - source: mc-resourcepack/cosmetics
      dest: plugins/Geary/template_pack
    - source: plugins/Geary/prefabs/cosmetics
      dest: plugins/Geary/prefabs/cosmetics

feat/bosses:
  copyPaths: [ "{{ privateSettingsDest }}/feat/bosses" ]

feat/loot_chests:
  copyPaths:
    - source: plugins/Geary/prefabs/mia-loot
      dest: plugins/Geary/prefabs/mia-loot

feat/items:
  copyPaths:
    - source: plugins/Geary/prefabs/mineinabyss/items
      dest: plugins/Geary/prefabs/mineinabyss/items
    - source: plugins/Geary/prefabs/minecraft/recipes
      dest: plugins/Geary/prefabs/minecraft/recipes
    - source: mc-resourcepack/items
      dest: plugins/Geary/template_pack

feat/hud:
  copyPaths:
      - source: plugins/BetterHud
        dest: plugins/BetterHud
# Servers
minecraft:
  copyPaths: [ .servers/minecraft ]
  variables:
    env:
      PRIVATE_PLUGINS_TOKEN: "{{ lookup('env', 'PRIVATE_PLUGINS_TOKEN') }}"
      PACKY_ACCESS_TOKEN: "{{ lookup('env', 'PACKY_ACCESS_TOKEN', default='UNKNOWN') }}"
      SERVER_NAME: "{{ lookup('env', 'SERVER_NAME', errors='ignore') }}"
      PACKY_PUBLIC_ADDRESS: "{{ lookup('env', 'PACKY_PUBLIC_ADDRESS', errors='ignore') }}"
      DISCORD_BOT_TOKEN: "{{ lookup('env', 'DISCORD_BOT_TOKEN', errors='ignore') }}"
    velocity_forward_secret: "{{ lookup('ansible.builtin.file', '/run/secrets/velocity_forwarding_secret', errors='ignore') | default(lookup('env', 'VELOCITY_FORWARDING_SECRET'), true) }}"
  include:
    - feat/chat
    - feat/emotes

survival:
  copyPaths: [ .servers/survival ]
  variables:
    chatty:
      enableHover: true
      serverPrefix: ":survival:"
  include:
    - minecraft
    - feat/items
    - feat/loot_chests
    - feat/cosmetics
    - feat/blocks
    - feat/mobs
    - feat/hud
build:
  variables:
    chatty:
      enableHover: true
      serverPrefix: ":build:"
      localChatRadius: 0
  copyPaths: [ .servers/build ]
  include:
    - minecraft
    - feat/blocks
    - feat/items
    - feat/loot_chests
    - feat/cosmetics

staging:
  copyPaths: [ ] # Staging should mimic another server as closely as possible, use `include` below instead
  variables:
    chatty:
      enableHover: true
      serverPrefix: ":survival::test:"
      localChatRadius: 0
  include:
    - survival

dev:
  copyPaths: [ .servers/dev ]
  variables:
    chatty:
      serverPrefix: ":test:"
      localChatRadius: 0
  include:
    - minecraft
    - feat/blocks
    - feat/items
    - feat/loot_chests
    - feat/cosmetics
    - feat/mobs
    - feat/pets
    - feat/delvers
    - feat/bosses
    - feat/hud

dev-alpha:
  copyPaths: [ .servers/dev-alpha ]
  include:
    - dev

# Used for local development, where as few plugins as possible are auto downloaded
dev-basic:
  include:
    - dev

archive:
  copyPaths: [ .servers/archive ]
  variables:
    chatty:
      serverPrefix: ":adventure:"
      localChatRadius: 0
  include:
    - minecraft

# Proxy
velocity:
  copyPaths: [ .servers/proxy ]
  variables:
    velocityForwardingSecret: "{{ lookup('ansible.builtin.file', '/run/secrets/velocity_forwarding_secret', errors='ignore') | default(lookup('env', 'VELOCITY_FORWARDING_SECRET'), true) }}"
    spicord:
      token: "{{ lookup('env', 'SPICORD_TOKEN') }}"
  include: [ ]
